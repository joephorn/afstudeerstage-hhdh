<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Albion - Ontwerp Toolkit</title>
    <script src="https://cdn.jsdelivr.net/npm/p5@1.11.10/lib/p5.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/p5.js-svg@1.6.0/dist/p5.svg.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/3.0.2/jspdf.umd.min.js"></script>
    <script src="https://unpkg.com/svg2pdf.js@2.2.4/dist/svg2pdf.umd.min.js"></script>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <main>
      <div id="blockLeft">
          <div id="canvasWrap"></div>
          <div id="exportBar" class="export-bar">
            <div class="bar-inner">
              <!-- Settings section -->
              <section class="control-section export-section export-section--settings" id="ui-export-settings">
                <div class="ui-section-head">
                  <h2 class="control-section-title">Settings</h2>
                </div>
                <div class="ui-row">
                  <label class="ui-label" for="preset">Size</label>
                  <div class="ui-control">
                    <select id="preset" class="visually-hidden">
                      <option value="fit" selected>Fit — fill screen</option>
                      <option value="ar1" data-aw="16" data-ah="9" data-w="1920" data-h="1080">16:9 — 1920 × 1080 (Full HD)</option>
                      <option value="ar2" data-aw="16" data-ah="9" data-w="1280" data-h="720">16:9 — 1280 × 720 (HD)</option>
                      <option value="ar3" data-aw="16" data-ah="9" data-w="3840" data-h="2160">16:9 — 3840 × 2160 (4K)</option>
                      <option value="ar4" data-aw="9" data-ah="16" data-w="1080" data-h="1920">9:16 — 1080 × 1920 (Vertical Full HD)</option>
                      <option value="ar5" data-aw="9" data-ah="16" data-w="720" data-h="1280">9:16 — 720 × 1280</option>
                      <option value="ar6" data-aw="1" data-ah="1" data-w="1080" data-h="1080">1:1 — 1080 × 1080</option>
                      <option value="ar7" data-aw="4" data-ah="5" data-w="1080" data-h="1350">4:5 — 1080 × 1350</option>
                      <option value="ar8" data-aw="3" data-ah="2" data-w="1620" data-h="1080">3:2 — 1620 × 1080</option>
                      <option value="ar9" data-aw="4" data-ah="3" data-w="1024" data-h="768">4:3 — 1024 × 768</option>
                      <option value="ar10" data-aw="4" data-ah="3" data-w="2048" data-h="1536">4:3 — 2048 × 1536</option>
                      <option value="ar11" data-aw="21" data-ah="9" data-w="2560" data-h="1080">21:9 — 2560 × 1080 (Ultrawide)</option>
                      <option value="ar12" data-aw="21" data-ah="9" data-w="3440" data-h="1440">21:9 — 3440 × 1440 (Ultrawide)</option>
                      <option value="custom" data-aw="" data-ah="" data-w="" data-h="">Custom…</option>
                    </select>
                    <div class="dropdown dropdown--text" data-link="#preset"></div>
                  </div>
                </div>
                <div class="ui-row" id="customARRow">
                  <label class="ui-label" for="aspectW">Custom resolution</label>
                  <div class="ui-control">
                    <div id="customAR" class="custom-resolution">
                      <label class="control-label inline-label">
                        <span>Custom resolution</span>
                        <span class="sub">pixels</span>
                      </label>
                      <div class="field-row">
                        <input id="aspectW" class="input-fluid" type="number" min="1" step="1" value="1920" placeholder="Width (px)" />
                        <input id="aspectH" class="input-fluid" type="number" min="1" step="1" value="1080" placeholder="Height (px)" />
                      </div>
                      <div class="field-row" style="align-items:center; gap:8px; margin-top:6px;">
                        <button id="applyCustomAR" type="button">Apply</button>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="ui-row">
                  <label class="ui-label" for="exportFormat">Format</label>
                  <div class="ui-control">
                    <select id="exportFormat" class="visually-hidden">
                      <option value="svg">SVG</option>
                      <option value="pdf">PDF</option>
                      <option value="mp4">MP4</option>
                      <option value="webm">WebM</option>
                    </select>
                    <div class="dropdown dropdown--text" data-link="#exportFormat"></div>
                    <input id="cfgFile" type="file" accept=".json,.txt" style="display:none" />
                  </div>
                </div>
              </section>

              <!-- Actions section -->
              <section class="control-section export-section export-section--actions" id="ui-export-actions">
                <div class="ui-section-head">
                  <h2 class="control-section-title">Actions</h2>
                </div>
                <div class="ui-row ui-row-actions">
                  <span class="ui-label"></span>
                  <div class="ui-control actions-grid">
                    <div class="actions-grid-row">
                      <button id="kfDel" type="button" class="button-with-shortcut" title="Remove keyframe">
                        <span>Remove kf</span>
                        <img class="shortcut-icon" data-icon-base="shortcut-minus" src="./src/icons/shortcut-minus.png" alt="Shortcut Minus" />
                      </button>
                      <button id="kfAdd" type="button" class="button-with-shortcut" title="Add keyframe">
                        <span>Add kf</span>
                        <img class="shortcut-icon" data-icon-base="shortcut-plus" src="./src/icons/shortcut-plus.png" alt="Shortcut Plus" />
                      </button>
                    </div>
                    <div class="actions-grid-row">
                      <button id="cfgLoad" type="button">Load scene</button>
                      <button id="cfgSave" type="button">Save scene</button>
                    </div>
                    <div class="actions-grid-row">
                      <button id="exportGo" type="button" class="actions-export">Export</button>
                    </div>
                  </div>
                </div>
              </section>

              <!-- Keyframes section -->
              <section class="control-section export-section export-section--keyframes" id="ui-export-keyframes">
                <div class="ui-section-head">
                  <h2 class="control-section-title">Scene</h2>
                </div>
                <div class="ui-row">
                  <label class="ui-label" for="kfToggle">Keyframes</label>
                  <div class="ui-control">
                    <div class="kf-row">
                      <button id="kfToggle" type="button" class="button-with-shortcut" title="Play/Pause">
                        <span class="kf-toggle-icon" aria-hidden="true">▶</span>
                        <img class="shortcut-icon" data-icon-base="shortcut-space" src="./src/icons/shortcut-space.png" alt="Shortcut Space" />
                      </button>
                      <div id="kfList" class="kf-list"></div>
                      <div class="shortcut-inline shortcut-inline--tight kf-list-shortcuts" aria-hidden="true">
                        <img id="kfShortcutPrev" class="shortcut-icon" data-icon-base="shortcut-left" src="./src/icons/shortcut-left.png" alt="Shortcut Left Arrow" />
                        <img id="kfShortcutNext" class="shortcut-icon" data-icon-base="shortcut-right" src="./src/icons/shortcut-right.png" alt="Shortcut Right Arrow" />
                      </div>
                    </div>
                  </div>
                </div>
                <div class="ui-row">
                  <label class="ui-label" for="kfTime">Kf Duration</label>
                  <div class="ui-control">
                    <input id="kfTime" class="visually-hidden" type="range" min="0.10" max="5" step="0.1" value="1.0" />
                    <div class="scalar" data-link="#kfTime" data-unit="Sec">
                      <div class="scalar__fill"></div>
                      <div class="scalar__value"></div>
                      <div class="scalar__unit">Sec</div>
                      <div class="scalar__edit"><input type="number" /></div>
                    </div>
                    <span id="kfTimeOut" class="sub visually-hidden"></span>
                  </div>
                </div>
                <div class="ui-row">
                  <label class="ui-label">All Duration</label>
                  <div class="ui-control">
                    <span id="kfTotalOut" class="sub">1.0 Sec</span>
                  </div>
                </div>
              </section>
            </div>
          </div>
      </div>

      <div id="controls">
        <!-- Redesigned control layout (WIP) -->
        <section class="control-section" id="ui-general">
          <div class="ui-section-head">
            <span class="sec-icon sec-icon--left" aria-hidden="true"></span>
            <h2 class="control-section-title">General</h2>
            <span class="sec-icon sec-icon--right" aria-hidden="true"></span>
          </div>
          <div class="ui-row">
            <label class="ui-label" for="genText">Text</label>
            <div class="ui-control">
              <select id="genText" class="visually-hidden"></select>
              <div class="dropdown dropdown--text" data-link="#genText"></div>
            </div>
          </div>
          <div class="ui-row">
            <label class="ui-label" for="genScale">Scale</label>
            <div class="ui-control">
              <input id="genScale" class="visually-hidden" type="range" min="10" max="200" step="1" value="100" />
              <div class="scalar" data-link="#genScale" data-unit="%">
                <div class="scalar__fill"></div>
                <div class="scalar__value"></div>
                <div class="scalar__unit">%</div>
                <div class="scalar__edit"><input type="number" /></div>
              </div>
            </div>
          </div>
          <div class="ui-row">
            <label class="ui-label" for="genWidth">Width</label>
            <div class="ui-control">
              <input id="genWidth" class="visually-hidden" type="range" min="0" max="500" step="1" value="110" />
              <div class="scalar" data-link="#genWidth" data-unit="%">
                <div class="scalar__fill"></div>
                <div class="scalar__value"></div>
                <div class="scalar__unit">%</div>
                <div class="scalar__edit"><input type="number" /></div>
              </div>
            </div>
          </div>
          <div class="ui-row">
            <label class="ui-label" for="genGap">Gap</label>
            <div class="ui-control">
              <input id="genGap" class="visually-hidden" type="range" min="-20" max="150" step="1" value="9" />
              <div class="scalar" data-link="#genGap" data-unit="px">
                <div class="scalar__fill"></div>
                <div class="scalar__value"></div>
                <div class="scalar__unit">px</div>
                <div class="scalar__edit"><input type="number" /></div>
              </div>
            </div>
          </div>
          <div class="ui-row">
            <label class="ui-label" for="genRows">Rows</label>
            <div class="ui-control">
              <input id="genRows" class="visually-hidden" type="range" min="4" max="32" step="4" value="12" />
              <div class="scalar" data-link="#genRows">
                <div class="scalar__fill"></div>
                <div class="scalar__value"></div>
                <div class="scalar__unit"></div>
                <div class="scalar__edit"><input type="number" /></div>
              </div>
            </div>
          </div>
          <div class="ui-row">
            <label class="ui-label" for="genLineHeight">Line Height</label>
            <div class="ui-control">
              <input id="genLineHeight" class="visually-hidden" type="range" min="1" max="50" step="1" value="10" />
              <div class="scalar" data-link="#genLineHeight" data-unit="px">
                <div class="scalar__fill"></div>
                <div class="scalar__value"></div>
                <div class="scalar__unit">px</div>
                <div class="scalar__edit"><input type="number" /></div>
              </div>
            </div>
          </div>
          <div class="ui-row">
            <label class="ui-label" for="genTipRatio">Tip Ratio</label>
            <div class="ui-control">
              <input id="genTipRatio" class="visually-hidden" type="range" min="0" max="1" step="0.01" value="0.30" />
              <div class="scalar" data-link="#genTipRatio" data-unit="%">
                <div class="scalar__fill"></div>
                <div class="scalar__value"></div>
                <div class="scalar__unit">%</div>
                <div class="scalar__edit"><input type="number" /></div>
              </div>
            </div>
          </div>
          <div class="ui-row">
            <label class="ui-label" for="genShape">Shape</label>
            <div class="ui-control">
              <select id="genShape" class="visually-hidden">
                <option value="rounded" data-icon-src="./src/shape-previews/shape-preview-rounded.svg">Rounded</option>
                <option value="straight" data-icon-src="./src/shape-previews/shape-preview-straight.svg">Straight</option>
                <option value="blocks" data-icon-src="./src/shape-previews/shape-preview-blocks.svg">Blocks</option>
                <option value="circles" data-icon-src="./src/shape-previews/shape-preview-circles.svg">Circles</option>
                <option value="pluses" data-icon-src="./src/shape-previews/shape-preview-plusjes.svg">Plusses</option>
              </select>
              <div class="dropdown dropdown--shape" data-link="#genShape"></div>
            </div>
          </div>
          <div class="ui-row">
            <label class="ui-label" for="genColor">Color</label>
            <div class="ui-control">
              <select id="genColor" class="visually-hidden"></select>
              <div class="dropdown dropdown--color" data-link="#genColor"></div>
            </div>
          </div>
          <div class="ui-row">
            <label class="ui-label" for="genBgLines">BG Lines</label>
            <input id="genBgLines" class="ui-control ui-checkbox" type="checkbox" />
          </div>
          <div class="ui-row">
            <label class="ui-label" for="genBgTransparent">BG Transparent</label>
            <input id="genBgTransparent" class="ui-control ui-checkbox" type="checkbox" />
          </div>
        </section>

        <section class="control-section" id="ui-displacement">
          <div class="ui-section-head">
            <span class="sec-icon sec-icon--left" aria-hidden="true"></span>
            <h2 class="control-section-title">Displace</h2>
            <span class="sec-icon sec-icon--right" aria-hidden="true"></span>
          </div>
          <div class="ui-row">
            <label class="ui-label" for="dispGroups">Groups</label>
            <div class="ui-control">
              <input id="dispGroups" class="visually-hidden" type="range" min="0" max="5" step="1" value="0" />
              <div class="scalar" data-link="#dispGroups">
                <div class="scalar__fill"></div>
                <div class="scalar__value"></div>
                <div class="scalar__unit"></div>
                <div class="scalar__edit"><input type="number" /></div>
              </div>
            </div>
          </div>
          <div class="ui-row">
            <label class="ui-label" for="dispOffset">Offset</label>
            <div class="ui-control">
              <input id="dispOffset" class="visually-hidden" type="range" min="0" max="80" step="1" value="0" />
              <div class="scalar" data-link="#dispOffset" data-unit="px">
                <div class="scalar__fill"></div>
                <div class="scalar__value"></div>
                <div class="scalar__unit">px</div>
                <div class="scalar__edit"><input type="number" /></div>
              </div>
            </div>
          </div>
        </section>

        <section class="control-section" id="ui-repeat">
          <div class="ui-section-head">
            <span class="sec-icon sec-icon--left" aria-hidden="true"></span>
            <h2 class="control-section-title">Repeat</h2>
            <span class="sec-icon sec-icon--right" aria-hidden="true"></span>
          </div>
          <div class="ui-row">
            <label class="ui-label" for="repeatModeButtons">Mode</label>
            <div class="ui-control button-row" id="repeatModeButtons">
              <button type="button" data-mode="off">Off</button>
              <button type="button" data-mode="uniform">Uniform</button>
              <button type="button" data-mode="falloff">Falloff</button>
            </div>
            <select id="repeatMode" class="visually-hidden">
              <option value="off">Off</option>
              <option value="uniform">Uniform</option>
              <option value="falloff">Falloff</option>
            </select>
          </div>
          <div class="ui-row">
            <label class="ui-label" for="repFalloff">Falloff</label>
            <div class="ui-control">
              <input id="repFalloff" class="visually-hidden" type="range" min="0.5" max="1" step="0.01" value="1.00" />
              <div class="scalar" data-link="#repFalloff">
                <div class="scalar__fill"></div>
                <div class="scalar__value"></div>
                <div class="scalar__unit"></div>
                <div class="scalar__edit"><input type="number" /></div>
              </div>
            </div>
          </div>
          <div class="ui-row">
            <label class="ui-label" for="repRows">Rows</label>
            <div class="ui-control">
              <input id="repRows" class="visually-hidden" type="range" min="0" max="0" step="1" value="0" />
              <div class="scalar" data-link="#repRows">
                <div class="scalar__fill"></div>
                <div class="scalar__value"></div>
                <div class="scalar__unit"></div>
                <div class="scalar__edit"><input type="number" /></div>
              </div>
            </div>
          </div>
          <div class="ui-row">
            <label class="ui-label" for="repMirror">Mirror</label>
            <input id="repMirror" class="ui-control ui-checkbox" type="checkbox" />
          </div>
        </section>

        <section class="control-section" id="ui-vwave">
          <div class="ui-section-head">
            <span class="sec-icon sec-icon--left" aria-hidden="true"></span>
            <h2 class="control-section-title">Wave Verticaal</h2>
            <span class="sec-icon sec-icon--right" aria-hidden="true"></span>
          </div>
          <div class="ui-row">
            <label class="ui-label" for="vWaveModeButtons">Mode</label>
            <div class="ui-control button-row" id="vWaveModeButtons">
              <button type="button" data-mode="off">Off</button>
              <button type="button" data-mode="mouse">Mouse</button>
              <button type="button" data-mode="pulse">Pulse</button>
              <button type="button" data-mode="scan">Scan</button>
            </div>
            <select id="vWaveMode" class="visually-hidden">
              <option value="off">Off</option>
              <option value="mouse">Mouse</option>
              <option value="pulse">Pulse</option>
              <option value="scan">Scan</option>
            </select>
          </div>
          <div class="ui-row">
            <label class="ui-label" for="vWaveCurveButtons">Curve</label>
            <div class="ui-control button-row" id="vWaveCurveButtons">
              <button type="button" data-mode="sine">Sine</button>
              <button type="button" data-mode="step">Step</button>
            </div>
            <select id="vWaveCurve" class="visually-hidden">
              <option value="sine">Sine</option>
              <option value="step">Step</option>
            </select>
          </div>
          <div class="ui-row">
            <label class="ui-label" for="vWaveDuration">Duration</label>
            <div class="ui-control">
              <input id="vWaveDuration" class="visually-hidden" type="range" min="2" max="10" step="0.1" value="3.0" />
              <div class="scalar" data-link="#vWaveDuration" data-unit="s">
                <div class="scalar__fill"></div>
                <div class="scalar__value"></div>
                <div class="scalar__unit">s</div>
                <div class="scalar__edit"><input type="number" /></div>
              </div>
            </div>
          </div>
          <div class="ui-row">
            <label class="ui-label" for="vWaveAmplitude">Amplitude</label>
            <div class="ui-control">
              <input id="vWaveAmplitude" class="visually-hidden" type="range" min="0" max="3" step="0.05" value="1.00" />
              <div class="scalar" data-link="#vWaveAmplitude" data-unit="×">
                <div class="scalar__fill"></div>
                <div class="scalar__value"></div>
                <div class="scalar__unit">×</div>
                <div class="scalar__edit"><input type="number" /></div>
              </div>
            </div>
          </div>
        </section>

        <section class="control-section" id="ui-hwave">
          <div class="ui-section-head">
            <span class="sec-icon sec-icon--left" aria-hidden="true"></span>
            <h2 class="control-section-title">Wave Horizontaal</h2>
            <span class="sec-icon sec-icon--right" aria-hidden="true"></span>
          </div>
          <div class="ui-row">
            <label class="ui-label" for="hWaveModeButtons">Mode</label>
            <div class="ui-control button-row" id="hWaveModeButtons">
              <button type="button" data-mode="off">Off</button>
              <button type="button" data-mode="on">On</button>
            </div>
            <select id="hWaveMode" class="visually-hidden">
              <option value="off">Off</option>
              <option value="on">On</option>
            </select>
          </div>
          <div class="ui-row">
            <label class="ui-label" for="hWaveDuration">Duration</label>
            <div class="ui-control">
              <input id="hWaveDuration" class="visually-hidden" type="range" min="0.5" max="10" step="0.1" value="3.0" />
              <div class="scalar" data-link="#hWaveDuration" data-unit="s">
                <div class="scalar__fill"></div>
                <div class="scalar__value"></div>
                <div class="scalar__unit">s</div>
                <div class="scalar__edit"><input type="number" /></div>
              </div>
            </div>
          </div>
          <div class="ui-row">
            <label class="ui-label" for="hWaveAmplitude">Amplitude</label>
            <div class="ui-control">
              <input id="hWaveAmplitude" class="visually-hidden" type="range" min="0" max="200" step="1" value="100" />
              <div class="scalar" data-link="#hWaveAmplitude" data-unit="%">
                <div class="scalar__fill"></div>
                <div class="scalar__value"></div>
                <div class="scalar__unit">%</div>
                <div class="scalar__edit"><input type="number" /></div>
              </div>
            </div>
          </div>
        </section>

        <section class="control-section" id="ui-transition">
          <div class="ui-section-head">
            <span class="sec-icon sec-icon--left" aria-hidden="true"></span>
            <h2 class="control-section-title">Transition</h2>
            <span class="sec-icon sec-icon--right" aria-hidden="true"></span>
          </div>
          <div class="ui-row">
            <label class="ui-label" for="transMode">Mode</label>
            <div class="ui-control">
              <select id="transMode" class="visually-hidden">
                <option value="smooth"    data-icon-src="./src/easing-previews/easing-1.png">Smoothstep</option>
                <option value="linear"    data-icon-src="./src/easing-previews/easing-0.png">Linear</option>
                <option value="easeInOut" data-icon-src="./src/easing-previews/easing-5.png">Ease In-Out</option>
                <option value="snap"      data-icon-src="./src/easing-previews/easing-4.png">Snap</option>
                <option value="snapHalf"  data-icon-src="./src/easing-previews/easing-3.png">Snap + Ease</option>
                <option value="fadeIn"    data-icon-src="./src/easing-previews/easing-2.png">Fade-In</option>
              </select>
              <div class="dropdown dropdown--ease" data-link="#transMode"></div>
            </div>
          </div>
          <div class="ui-row">
            <label class="ui-label" for="transDuration">Duration</label>
            <div class="ui-control">
              <input id="transDuration" class="visually-hidden" type="range" min="0" max="200" step="1" value="100" />
              <div class="scalar" data-link="#transDuration" data-unit="%">
                <div class="scalar__fill"></div>
                <div class="scalar__value"></div>
                <div class="scalar__unit">%</div>
                <div class="scalar__edit"><input type="number" /></div>
              </div>
            </div>
          </div>
          <div class="ui-row">
            <label class="ui-label" for="transAmplitude">Amplitude</label>
            <div class="ui-control">
              <input id="transAmplitude" class="visually-hidden" type="range" min="0" max="2" step="0.05" value="1.00" />
              <div class="scalar" data-link="#transAmplitude" data-unit="×">
                <div class="scalar__fill"></div>
                <div class="scalar__value"></div>
                <div class="scalar__unit">×</div>
                <div class="scalar__edit"><input type="number" /></div>
              </div>
            </div>
          </div>
        </section>

        <section class="control-section" id="ui-quick-actions">
          <div class="ui-section-head">
            <span class="sec-icon sec-icon--left" aria-hidden="true"></span>
            <h2 class="control-section-title">Actions</h2>
          </div>
          <div class="ui-row ui-row-actions">
            <span class="ui-label"></span>
            <div class="ui-control button-row">
              <button id="qaRandomize" type="button" class="button-with-shortcut">
                <span>Randomize</span>
                <img class="shortcut-icon" data-icon-base="shortcut-r" src="./src/icons/shortcut-r.png" alt="Shortcut R" />
              </button>
              <button id="qaFill" type="button">Transition fill</button>
              <button id="qaReset" type="button">Reset</button>
            </div>
          </div>
        </section>

        <!-- Hide legacy controls to keep current functionality intact -->
        <div id="legacyControls" class="legacy-controls">
        <section class="control-section">
          <h2 class="control-section-title">General</h2>
          <div class="control-field">
            <label class="control-label" for="logoText">
              <span>Text</span>
            </label>
            <select id="logoText" class="control-select control-select--tight"></select>
          </div>
          <div class="control-field">
            <label class="control-label" for="logoScale">
              <span>Scale</span>
              <span id="logoScaleOut" class="sub">100 %</span>
            </label>
            <input id="logoScale" type="range" min="10" max="200" step="1" value="100" />
          </div>
          <div class="control-field">
            <label class="control-label" for="rows">
              <span>Rows</span>
              <span id="rowsOut" class="sub">—</span>
            </label>
            <input id="rows" type="range" min="4" max="32" step="4" value="12" />
          </div>
          <div class="control-field">
            <label class="control-label" for="thickness">
              <span>Line height</span>
              <span id="thicknessOut" class="sub">— px</span>
            </label>
            <input id="thickness" type="range" min="1" max="50" step="1" value="10" />
          </div>
          <div class="control-field">
            <label class="control-label" for="tipRatio">
              <span>Tip ratio</span>
              <span id="tipOut" class="sub">0.30</span>
            </label>
            <input id="tipRatio" type="range" min="0" max="1" step="0.01" value="0.30" />
          </div>
          <div class="control-field">
            <label class="control-label" for="widthScale">
              <span>Width</span>
              <span id="widthOut" class="sub">— %</span>
            </label>
            <input id="widthScale" type="range" min="0" max="500" step="1" value="110" />
            <div class="field-row" style="align-items:center; gap:8px; margin-top:6px;">
              <button id="fillBtn" type="button" title="Maak lijnen 2.80× langer">Fill ×2.8</button>
            </div>
          </div>
          <div class="control-field">
            <label class="control-label" for="gap">
              <span>Gap</span>
              <span id="gapOut" class="sub">— px</span>
            </label>
            <input id="gap" type="range" min="-20" max="150" step="1" value="9" />
          </div>
          <div class="control-field">
            <label class="control-label" for="taperIndex">
              <span>Shape</span>
              <span id="taperIndexOut" class="sub">1</span>
            </label>
            <input id="taperIndex" type="range" min="1" max="5" step="1" value="1" />
            <div class="sub" style="margin-top:4px; opacity:.5; font-size:12px;">
              Rounded Straight Circles Blocks Pluses
            </div>
          </div>
          <div class="control-row">
            <label class="checkbox-label">
              <input id="perfMode" type="checkbox" /> Performance mode (reduce detail during playback)
            </label>
          </div>
        </section>

        <section class="control-section">
          <h2 class="control-section-title">Displace</h2>
          <div class="control-field">
            <label class="control-label" for="groups">
              <span>Groups</span>
              <span id="groupsOut" class="sub">—</span>
            </label>
            <input id="groups" type="range" min="0" max="5" step="1" value="0" />
          </div>
          <div class="control-field">
            <label class="control-label" for="dispUnit">
              <span>Unit</span>
              <span id="dispUnitOut" class="sub">28 px</span>
            </label>
            <input id="dispUnit" type="range" min="0" max="80" step="1" value="28" />
          </div>
        </section>

        <section class="control-section">
          <h2 class="control-section-title">Color</h2>
          <div class="control-field">
            <label class="control-label" for="colorPreset">
              <span>Preset</span>
              <span class="sub" id="colorPresetLabel">Preset</span>
            </label>
            <select id="colorPreset" class="visually-hidden"></select>
            <div class="dropdown dropdown--color" data-link="#colorPreset"></div>
          </div>
          <div class="control-row">
            <label class="checkbox-label">
              <input id="bgLines" type="checkbox" /> Background lines
            </label>
          </div>
          <div class="control-row">
            <label class="checkbox-label">
              <input id="bgTransparent" type="checkbox" /> Transparant background
            </label>
          </div>
        </section>

        <section class="control-section">
          <h2 class="control-section-title">Wave</h2>
          <div class="control-row">
            <label class="checkbox-label">
              <input id="animEnabled" type="checkbox" /> Enabled
            </label>
          </div>
          <div class="control-field">
            <label class="control-label" for="pulsePhase">
              <span>Wave phase</span>
              <span id="pulsePhaseOut" class="sub">0.00</span>
            </label>
            <input id="pulsePhase" type="range" min="0" max="1" step="0.001" value="0" />
          </div>
          <div class="control-row">
            <label class="control-label control-label--inline">Mode</label>
            <label class="checkbox-label"><input type="radio" name="animMode" id="animOff" checked> Off</label>
            <label class="checkbox-label"><input type="radio" name="animMode" id="animMouse"> Mouse</label>
            <label class="checkbox-label"><input type="radio" name="animMode" id="animPulse"> Pulse ⇆</label>
            <label class="checkbox-label"><input type="radio" name="animMode" id="animScan"> Scan →</label>
          </div>
          <div class="control-row">
            <label class="control-label control-label--inline">Curve</label>
            <label class="checkbox-label"><input type="radio" name="curve" id="curveSine" checked> Sine</label>
            <label class="checkbox-label"><input type="radio" name="curve" id="curveSmooth"> Step</label>
          </div>
          <div class="control-field">
            <label class="control-label" for="animPeriod">
              <span>Duration</span>
              <span id="animPeriodOut" class="sub">0s</span>
            </label>
            <input id="animPeriod" type="range" min="2" max="10" step="0.1" value="3.0" />
          </div>
          <div class="control-field">
            <label class="control-label" for="powerCtl">
              <span>Amplitude</span>
              <span id="powerOut" class="sub">1.00×</span>
            </label>
            <input id="powerCtl" type="range" min="0.00" max="3" step="0.05" value="1" />
          </div>
          <div class="control-field">
            <label class="control-label" for="hWaveAmp">
              <span>Horizontal wave amplitude</span>
              <span id="hWaveAmpOut" class="sub">0.00×</span>
            </label>
            <input id="hWaveAmp" type="range" min="0" max="5" step="0.01" value="0" />
          </div>
          <div class="control-field">
            <label class="control-label" for="hWavePeriod">
              <span>Horizontal wave duration</span>
              <span id="hWavePeriodOut" class="sub">3.00 s</span>
            </label>
            <input id="hWavePeriod" type="range" min="0.5" max="10" step="0.1" value="3.0" />
          </div>
        </section>

        <section class="control-section">
          <h2 class="control-section-title">Repeat</h2>
          <div class="control-row">
            <label class="checkbox-label">
              <input id="repeatEnabled" type="checkbox" /> Enabled
            </label>
          </div>
          <div class="control-row">
            <label class="checkbox-label"><input type="radio" name="repeatMode" id="repeatModeUniform" checked> Uniform</label>
            <label class="checkbox-label"><input type="radio" name="repeatMode" id="repeatModeFalloff"> Falloff</label>
          </div>
          <div class="control-field">
            <label class="control-label" for="repeatFalloff">
              <span>Falloff</span>
              <span id="repeatFalloffOut" class="sub">1.00</span>
            </label>
            <input id="repeatFalloff" type="range" min="0.5" max="1" step="0.01" value="1.00" />
          </div>
          <div class="control-row">
            <label class="checkbox-label">
              <input id="repeatMirror" type="checkbox" /> Mirror
            </label>
          </div>
          <div class="control-group" id="repeatWindow">
            <label class="control-label" for="repeatExtraRows">
              <span>Extra rows</span>
              <output id="repeatExtraRowsOut" class="sub">0</output>
            </label>
            <input id="repeatExtraRows" type="range" min="0" max="0" step="1" value="0" />
          </div>
        </section>

        <section class="control-section">
          <h2 class="control-section-title">Easing</h2>
          <div class="control-field">
            <label class="control-label" for="easeType">
              <span>Type</span>
              <span class="sub">for slider transitions</span>
            </label>
            <select id="easeType" class="control-select control-select--tight">
              <option value="smooth" selected>Smoothstep</option>
              <option value="linear">Linear</option>
              <option value="easeInOut">Ease In-Out</option>
              <option value="snap">Snap</option>
              <option value="snapHalf">Snap + Ease</option>
              <option value="fadeIn">Fade-In (line height)</option>
            </select>
          </div>
          <div class="control-field">
            <label class="control-label" for="easeDurPct">
              <span>Duration %</span>
              <span id="easeDurPctOut" class="sub">100 %</span>
            </label>
            <input id="easeDurPct" type="range" min="0" max="200" step="1" value="100" />
          </div>
          <div class="control-field">
            <label class="control-label" for="easeAmp">
              <span>Amplitude</span>
              <span id="easeAmpOut" class="sub">1.00×</span>
            </label>
            <input id="easeAmp" type="range" min="0" max="2" step="0.05" value="1.00" />
          </div>
        </section>

        <section class="control-section">
          <h2 class="control-section-title">Randomizer</h2>
          <div class="control-row">
            <label class="checkbox-label">
              <input id="autorand" type="checkbox" /> Auto randomize
            </label>
          </div>
          <div class="control-field">
            <label class="control-label" for="autorandDur">
              <span>Duration</span>
            <span id="autorandDurOut" class="sub">0.50 s</span>
          </label>
          <input id="autorandDur" type="range" min="0.5" max="5" step="0.1" value="0.5" />
          </div>
          <!-- Debug mode (temporarily disabled)
          <div class="control-row is-muted">
            <label class="checkbox-label">
              <input id="debug" type="checkbox" /> Debug mode
            </label>
          </div>
          -->
        </section>

        

        <section class="control-section">
          <h2 class="control-section-title">ID</h2>
          <div class="control-field">
            <input id="idCode" class="input-fluid" type="text" placeholder="s100r12lh10w110g9…" />
          </div>
          <div class="button-group">
            <button id="idGet" type="button">Get</button>
            <button id="idSet" type="button">Set</button>
            <button id="idCopy" type="button">Copy</button>
          </div>
          <div id="idStatus" class="sub"></div>
        </section>

        <section class="control-section">
          <div class="button-group">
            <button id="resetDefaults" type="button">Reset</button>
          </div>
        </section>
        </div><!-- /legacyControls -->
      </div>
    </main>
    <script src="./src/kleuren.js"></script>
    <script src="sketch.js"></script>
    <script src="./src/custom-slider.js"></script>
    <script src="./src/custom-dropdown.js"></script>

  </body>
</html>
